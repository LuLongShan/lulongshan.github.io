<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>
        Rust Reference And Borrowing - Joe
      </title>
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  
  <meta name="theme-color" content="#000000" />
  
  <meta http-equiv="window-target" content="_top" />
  
  
  <meta name="description" content="Rustä¸­çš„å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrowing) åœ¨ä¸Šä¸€èŠ‚çš„æ‰€æœ‰æƒç³»ç»Ÿçš„æœ€åï¼Œå®˜æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœ" />
  <meta name="generator" content="Hugo 0.62.2 with theme pure" />
  <title>Rust Reference And Borrowing - Joe</title>
  
  
  <link rel="stylesheet" href="https://holicc.github.io/css/style.min.7dc20efbc53647d41aa9ddea0c48e59300223d084e66ea0cbe7c30bd88903acc.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  
  <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.css"
    integrity="sha384-bsHo4/LA+lkZv61JspMDQB9QP1TtO4IgOf2yYS+J6VdAYLVyx1c3XKcsHh0Vy8Ws" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"
    integrity="sha384-4z8mjH4yIpuK9dIQGR1JwbrfYsStrNK6MP+2Enhue4eyo0XlBDXOIPc8b6ZU0ajz" crossorigin="anonymous"></script>
  <meta property="og:title" content="Rust Reference And Borrowing" />
<meta property="og:description" content="Rustä¸­çš„å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrowing) åœ¨ä¸Šä¸€èŠ‚çš„æ‰€æœ‰æƒç³»ç»Ÿçš„æœ€åï¼Œå®˜æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://holicc.github.io/2020/07/rust-references-and-borrowing/" />
<meta property="article:published_time" content="2020-07-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-07T00:00:00+00:00" />
<meta itemprop="name" content="Rust Reference And Borrowing">
<meta itemprop="description" content="Rustä¸­çš„å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrowing) åœ¨ä¸Šä¸€èŠ‚çš„æ‰€æœ‰æƒç³»ç»Ÿçš„æœ€åï¼Œå®˜æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœ">
<meta itemprop="datePublished" content="2020-07-07T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-07-07T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1345">



<meta itemprop="keywords" content="programing,rust," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rust Reference And Borrowing"/>
<meta name="twitter:description" content="Rustä¸­çš„å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrowing) åœ¨ä¸Šä¸€èŠ‚çš„æ‰€æœ‰æƒç³»ç»Ÿçš„æœ€åï¼Œå®˜æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœ"/>

  <!--[if lte IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
    <![endif]-->

  <!--[if lt IE 9]>
      <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->

</head>
  </head>

  
  

  <body class="main-center theme-white" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/LuLongShan" target="_blank">
            <img class="img-circle img-rotate" src="https://holicc.github.io/avatar.png" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">Joe</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">Hello World</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>ChengDu, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">Ã—</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title"> Categories</h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://holicc.github.io/categories/mysql/" class="category-list-link">mysql</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://holicc.github.io/categories/programing/" class="category-list-link">programing</a><span class="category-list-count">10</span></li>
            <li class="category-list-item"><a href="https://holicc.github.io/categories/protocol/" class="category-list-link">protocol</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://holicc.github.io/categories/rocketmq/" class="category-list-link">rocketmq</a><span class="category-list-count">1</span></li>
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> Tags</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/index/" class="tag-list-link">index</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/mysql/" class="tag-list-link">mysql</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/networking/" class="tag-list-link">networking</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/programing/" class="tag-list-link">programing</a><span
                    class="tag-list-count">10</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/rocketmq/" class="tag-list-link">rocketmq</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/rust/" class="tag-list-link">rust</a><span
                    class="tag-list-count">9</span></li>
            
            
            <li class="tag-list-item"><a href="https://holicc.github.io/tags/tcp/" class="tag-list-link">tcp</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://holicc.github.io/2020/07/rocketmq-overstock/" class="title">Rust Function</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-07-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-12</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://holicc.github.io/2020/07/rust-packages-management/" class="title">Rust Packages Management</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-07-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-10</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://holicc.github.io/2020/07/rust-enums-and-patter-match/" class="title">Rust Enums And Patter Match</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-07-09 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-09</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://holicc.github.io/2020/07/rust-struct/" class="title">Rust Struct</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-07-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-08</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://holicc.github.io/2020/07/rust-references-and-borrowing/" class="title">Rust Reference And Borrowing</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-07-07 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-07</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Catalogue</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/2020/07/rust-references-and-borrowing/"
    >Rust Reference And Borrowing</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://holicc.github.io/2020/07/rust-references-and-borrowing/" class="article-date">
  <time datetime="2020-07-07 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-07-07</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/programing/"> programing </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/programing/"> programing </a>
    <a class="article-tag-link" href="/tags/rust/"> rust </a>
  </span>

        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/2020/07/rust-references-and-borrowing/#comments"
            class="article-comment-link">Comments</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 1345words</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Count: 3minutes </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <h3 id="rustä¸­çš„å¼•ç”¨referenceä¸å€Ÿç”¨borrowing">Rustä¸­çš„å¼•ç”¨(Reference)ä¸å€Ÿç”¨(Borrowing)</h3>

<p>åœ¨ä¸Šä¸€èŠ‚çš„æ‰€æœ‰æƒç³»ç»Ÿçš„æœ€åï¼Œå®˜æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœæŠŠå‚æ•°ä¼ è¿›å»å°±æŠŠæ‰€æœ‰æƒç§»äº¤åˆ°äº†å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆåç»­åˆå¦‚ä½•ä½¿ç”¨è¿™ä¸ªç§»äº¤æ‰€æœ‰æƒåçš„å˜é‡å‘¢ï¼Ÿ</p>

<pre><code class="language-rust">fn main() {
    let s1 = String::from(&quot;hello&quot;);

    let (s2, len) = calculate_length(s1);

    println!(&quot;The length of '{}' is {}.&quot;, s2, len);
}

fn calculate_length(s: String) -&gt; (String, usize) {
    let length = s.len(); // len() returns the length of a String

    (s, length)
}
</code></pre>

<p>å®˜æ–¹ç»™å‡ºçš„ä»£ç å¦‚ä¸Šï¼Œä½†æ˜¯è¿™æ ·å†™å°±å¤ªç¹çäº†ã€‚</p>

<p>æœ¬èŠ‚å°±æ˜¯è®²å¦‚ä½•ä½¿ç”¨<code>Reference</code>å’Œ<code>Borrorwing</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>

<p>å…ˆæ¥ä¸€æ®µä»£ç èµ·æ‰‹</p>

<pre><code class="language-rust">fn main() {
    let s1 = String::from(&quot;hello&quot;);

    let len = calculate_length(&amp;s1);

    println!(&quot;The length of '{}' is {}.&quot;, s1, len);
}

fn calculate_length(s: &amp;String) -&gt; usize {
    s.len()
}
</code></pre>

<p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œæˆ‘ç†è§£çš„æ˜¯ä¼ é€’çš„æ˜¯<code>s1</code>å˜é‡çš„æŒ‡é’ˆï¼Œæ‰€æœ‰<code>s1</code>å˜é‡çš„æ‰€æœ‰æƒæ²¡æœ‰ç§»äº¤å‡ºå»ã€‚</p>

<p><code>&amp;</code>è¿™ä¸ªç¬¦å·ï¼Œè®°å¾—åœ¨Cè¯­è¨€ä¸­æ˜¯<strong>å–åœ°å€</strong>çš„æ„æ€ã€‚</p>

<blockquote>
<p>The &amp;s1 syntax lets us create a reference that refers to the value of s1 but does not own it. Because it does not own it, the value it points to will not be dropped when the reference goes out of scope.</p>
</blockquote>

<p>åœ¨Rustä¸­è¿™æ ·ä½¿ç”¨<strong>å¼•ç”¨</strong>çš„æ–¹å¼å«åš<code>Borrowing</code>å€Ÿç”¨,è¿™ç§æ–¹å¼å…è®¸è·å–ä¸€ä¸ªå€¼çš„å¼•ç”¨è€Œä¸ç”¨ç§»äº¤æ‰€æœ‰æƒ,å› ä¸ºä½ å§‹ç»ˆæ˜¯ä¸œè¥¿çš„ä¸»äººï¼Œåˆ«äººåªæ˜¯å€Ÿç”¨äº†ä½ çš„ä¸œè¥¿ã€‚</p>

<blockquote>
<p>We call having references as function parameters borrowing. As in real life, if a person owns something, you can borrow it from them. When youâ€™re done, you have to give it back.</p>
</blockquote>

<p>é‚£ä¹ˆå°±æœ‰ä¸ªé—®é¢˜ï¼Œåˆ«äººå€Ÿçš„ä¸œè¥¿<em>â€˜å¼„åäº†æ€ä¹ˆåŠï¼Ÿâ€™</em></p>

<p>ä¸€ä¸‹ä»£ç ä¸èƒ½ç¼–è¯‘é€šè¿‡æ˜¯å› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹åˆ«äººçš„ä¸œè¥¿ã€‚</p>

<pre><code class="language-rust">fn main() {
    let s = String::from(&quot;hello&quot;);

    change(&amp;s);
}

fn change(some_string: &amp;String) {
    some_string.push_str(&quot;, world&quot;);
}
</code></pre>

<p>å¦‚æœå¼ºè¡Œä¿®æ”¹åˆ«äººçš„ä¸œè¥¿é‚£ä¹ˆå°±éœ€è¦è¿™æ ·å†™ï¼ˆç›¸å½“äºåœ¨ä¿®æ”¹åˆ«äººçš„ä¸œè¥¿æ—¶ï¼Œå…ˆé—®ä¸€å¥ï¼šâ€œæˆ‘å¯ä»¥ä¿®æ”¹ä½ çš„æ•°æ®å—ï¼Ÿâ€ï¼‰</p>

<pre><code class="language-rust">fn main() {
    let mut s = String::from(&quot;hello&quot;);

    change(&amp;mut s);
}

fn change(some_string: &amp;mut String) {
    some_string.push_str(&quot;, world&quot;);
}
</code></pre>

<p>ä½†æ˜¯å‘¢ï¼Œè¿™æ ·åˆæœ‰å¾ˆå¤šçš„é™åˆ¶ï¼Œä½ ä¸èƒ½æŠŠä¸œè¥¿å€Ÿç»™å¤šä¸ªæƒ³è¦ä¿®æ”¹çš„äººã€‚</p>

<pre><code class="language-rust">fn main() {
    let mut s = String::from(&quot;hello&quot;);

    let r1 = &amp;mut s;
    let r2 = &amp;mut s;

    println!(&quot;{}, {}&quot;, r1, r2);
}
</code></pre>

<blockquote>
<p>Data races cause undefined behavior and can be difficult to diagnose and fix when youâ€™re trying to track them down at runtime; Rust prevents this problem from happening because it wonâ€™t even compile code with data races!</p>
</blockquote>

<p>ä¸ºä»€ä¹ˆä¸è®¸å…è®¸åŒä¸€å¼•ç”¨çš„å¤šå‡ºä¿®æ”¹ï¼Œæ˜¯ä¸ºäº†é¿å…æ•°æ®ç«äº‰å¸¦æ¥çš„å„ç§ä¸å®‰å…¨çš„è¡Œä¸ºã€‚</p>

<p>ä¸€ç§æŠ˜ä¸­çš„å†™æ³•æ˜¯ï¼š</p>

<pre><code class="language-rust">fn main() {
    let mut s = String::from(&quot;hello&quot;);

    {
        let r1 = &amp;mut s;
    } // r1 goes out of scope here, so we can make a new reference with no problems.

    let r2 = &amp;mut s;
}
</code></pre>

<p>ä½†æ˜¯ä¸èƒ½é€šæ˜¯æŠŠä¸å¯å˜å¼•ç”¨å’Œå¯å˜å¼•ç”¨éƒ½å€Ÿå‡ºå»ï¼š</p>

<pre><code class="language-rust">fn main() {
    let mut s = String::from(&quot;hello&quot;);

    let r1 = &amp;s; // no problem
    let r2 = &amp;s; // no problem
    let r3 = &amp;mut s; // BIG PROBLEM

    println!(&quot;{}, {}, and {}&quot;, r1, r2, r3);
}
</code></pre>

<p>WTF?! æ‰“è„¸</p>

<pre><code class="language-rust">fn main() {
    let mut s = String::from(&quot;hello&quot;);

    let r1 = &amp;s; // no problem
    let r2 = &amp;s; // no problem
    println!(&quot;{} and {}&quot;, r1, r2);
    // r1 and r2 are no longer used after this point

    let r3 = &amp;mut s; // no problem
    println!(&quot;{}&quot;, r3);
}
</code></pre>

<blockquote>
<p>Note that a referenceâ€™s scope starts from where it is introduced and continues through the last time that reference is used. For instance, this code will compile because the last usage of the immutable references occurs before the mutable reference is introduced:</p>
</blockquote>

<p>å®˜æ–¹æ–‡æ¡£å‘Šè¯‰æˆ‘ï¼Œåªè¦ä¸å¯å˜çš„å¼•ç”¨è¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¢«é‡Šæ”¾ï¼Œä»è€Œåç»­å®šä¹‰çš„å¯å˜å¼•ç”¨<code>r3</code>å®šä¹‰å°±æ˜¯èƒ½å¤Ÿç¼–è¯‘é€šè¿‡çš„ã€‚</p>

<p>è¿™ä¸ªâ€œå¥‡æ€ªâ€çš„è®¾è®¡ï¼Œå®˜æ–¹ä¹Ÿç»™å‡ºäº†å®‰æ…°</p>

<blockquote>
<p>Even though borrowing errors may be frustrating at times, remember that itâ€™s the Rust compiler pointing out a potential bug early (at compile time rather than at runtime) and showing you exactly where the problem is. Then you donâ€™t have to track down why your data isnâ€™t what you thought it was.</p>
</blockquote>

<p>ç¼–è¯‘æ—¶æœŸå‘èƒ½å‘ç°çš„é—®é¢˜ï¼Œæ€»æ¯”è¿è¡Œæ—¶çš„å¼‚å¸¸å¥½å§ ğŸ˜‚ã€‚</p>

<p>ä¹‹å‰è¯´åˆ°ä¼šæŠŠâ€å€Ÿæ¥çš„ä¸œè¥¿ç©åâ€œï¼Œå°±æ˜¯ä¸€ä¸‹è¿™ç§æƒ…å†µï¼Œä¸“ä¸šæœ¯è¯­<code>dangle</code> <strong>æ‚¬å‚æŒ‡é’ˆ</strong>:</p>

<pre><code class="language-rust">fn main() {
    let reference_to_nothing = dangle();
}

fn dangle() -&gt; &amp;String { // dangle returns a reference to a String

    let s = String::from(&quot;hello&quot;); // s is a new String

    &amp;s // we return a reference to the String, s
} // Here, s goes out of scope, and is dropped. Its memory goes away.
  // Danger!
</code></pre>

<p>å› ä¸ºæ˜¯å€Ÿç”¨æ¥çš„ä¸œè¥¿ï¼Œåœ¨ä½¿ç”¨å®Œåå°±ä¼šè¢«é‡Šæ”¾æ‰ï¼Œç„¶è€Œè¿™é‡ŒæŠŠä»–ä½œä¸ºè¿”å›å€¼è¿”å›å°±ä¼šé€ æˆæ‚¬å‚æŒ‡é’ˆçš„å‡ºç°ã€‚</p>

<p>è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦è¿”å›ä¸€ä¸ªæ–°çš„ä¸œè¥¿å°±è¡Œäº†ã€‚</p>

<pre><code class="language-rust">fn main() {
    let string = no_dangle();
}

fn no_dangle() -&gt; String {
    let s = String::from(&quot;hello&quot;);

    s
}
</code></pre>

<p>å­¦ä¹ åˆ°ç°åœ¨ï¼Œè¿™äº›ä¸œè¥¿éƒ½è¿˜æ˜¯èƒ½å¤Ÿç†è§£çš„ï¼Œéƒ½æ˜¯ä¸ºäº†è§£å†³åƒåœ¾å›æ”¶å†…å­˜å®‰å…¨ç›¸å…³è€Œå‘æ˜çš„ç‰¹æ€§ã€‚</p>

<p>å®Œ!</p>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>Permalink: </strong>
      <a href="https://holicc.github.io/2020/07/rust-references-and-borrowing/" title="Rust Reference And Borrowing" target="_blank" rel="external">https://holicc.github.io/2020/07/rust-references-and-borrowing/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Licenseï¼š</strong><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/LuLongShan" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://holicc.github.io/avatar.png" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/LuLongShan" target="_blank"><span class="text-dark">Joe</span><small class="ml-1x">Hello World</small></a></h3>
        <div>people are resources</div>
      </div>
    </figure>
  </div>
</div>
    </div>
  </article>
<section id="comments">
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://holicc.github.io/2020/07/rust-ownership/" title="Rust Function"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://holicc.github.io/2020/07/rust-struct/"
                    title="Rust Struct"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="Catalogue" role="button">
                    <span>[&nbsp;</span><span>Catalogue</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone"></div>
        </div>
    </div>
</nav>

</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/LuLongShan" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://holicc.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2017  -
    2020
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/java.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/go.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/sql.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/rust.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://holicc.github.io/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://holicc.github.io/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            ROOT_URL: 'https:\/\/holicc.github.io\/',
            CONTENT_URL: 'https:\/\/holicc.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://holicc.github.io/js/insight.min.a343cd9a5a7698336b28ef3a7c16a3a1b1d2d5fb17dc8ed04022bbe08cc5459073a15bdafa3a8a58cdd56080784bdd69fa70b1ae8597565c799c57ed00f0e120.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>

<script>
    var disqus_config = function () {
        this.page.url = 'https:\/\/holicc.github.io\/2020\/07\/rust-references-and-borrowing\/';
        this.page.identifier = 'takijoe';
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = '//' + 'takijoe' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-157580785-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </body>
</html>
